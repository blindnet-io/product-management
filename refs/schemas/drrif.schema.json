{
  "$id": "https://blindnet.io/schemas/rights-request",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  
  "title": "Data Rights Request",
  "description": "This document defines a format for interoperability of Data Rights Requests",
  
  "type": "object",
  "properties": {
        "request-id": {
            "type": "string",
            "format": "uuid"
        },
    
        "data-subject": {
            "type": "array",
            "items": { "$ref": "#/$defs/data-subject-identity" }, 
            "minItems": 1
        },
    
         "demands": {
            "type": "array",
            "items": { "$ref": "#/$defs/demand" }, 
            "minItems": 1
        },
    
        "transitivity": {
         "enum": ["DOWNWARD","UPWARD","BIDIRECTIONAL","INTRANSITIVE"],
         "default": "INTRANSITIVE",
        },

        "date": {
            "type": "string",
            "format": "date-time"
        },

        "reply-to": {
         "enum": ["SYSTEM","USER"] 
        },
    
        "legal-grounds": {
          "type": "array",
          "items": { "type": "string" } 
        },
    
        "consent-ids": {
          "type": "array",
          "items": { 
            "type": "string",
            "format": "uuid"
          } 
        },
      "capture-ids": {
          "type": "array",
          "items": { 
            "type": "string",
            "format": "uuid"
          } 
      }

  },
  
  "required": ["rights-request-id", "timestamp"],

  "definitions": {
      
  },
  
  "$defs": {
      "data-subject-identity": {
        "$id": "/schemas/data-subject-identity",
        "$schema": "https://json-schema.org/draft/2020-12/schema#",
        "type": "object",
        
        "properties": {
          "dsid-schema": { "type": "string" },
          "dsid": { "type": "string" },
         },
        
        "required": ["dsid-schema", "dsid"],

      },
        
     "demand": {
        "$id": "/schemas/demand",
        "$schema": "https://json-schema.org/draft/2020-12/schema#",
        "type": "object",
        
        "properties": {
          "demande-id": {
            "type": "string"
          },
          
          "action": {
            "enum":["ACCESS",
                    "DELETE",
                    "MODIFY",
                    "PORTABILITY",
                    "OBJECT",
                    "REVOKE-CONSENT",
                    "TRANSPARENCY",
                    "TRANSPARENCY.WHERE",
                    "TRANSPARENCY.WHO",
                    "TRANSPARENCY.PROVENANCE",
                    "TRANSPARENCY.RETENTION",
                    "TRANSPARENCY.POLICY",
                    "TRANSPARENCY.PURPOSE",
                    "TRANSPARENCY.PROCESSING"]
          },
          
         "data-categories": {
            "enum": ["AFFILIATION",
                     "BEHAVIOR",
                     "BEHAVIOR.CONNECTION",
                     "BEHAVIOR.ACTIVITY",
                     "BEHAVIOR.PREFERENCE",
                     "BIOMETRIC",
                     "CONTACT",
                     "CONTACT.EMAIL",
                     "CONTACT.ADDRESS",
                     "CONTACT.PHONE",
                     "DEMOGRAPHIC",
                     "DEMOGRAPHIC.AGE",
                     "DEMOGRAPHIC.BELIEFS",
                     "DEMOGRAPHIC.GENDER",
                     "DEMOGRAPHIC.ORIGIN",
                     "DEMOGRAPHIC.RACE",
                     "DEVICE",
                     "FINANCIAL",
                     "GENETIC",
                     "HEALTH",
                     "IMAGE",
                     "LOCATION",
                     "NAME",
                     "RELATIONSHIPS",
                     "PROFILING",
                     "UID",
                     "OTHER"] 
         },
          
          "processing-categories": {
            "enum": ["ANONYMIZATION",
                     "AUTOMATED-INFERENCE",
                     "AUTOMATED-DECISION-MAKING",
                     "COLLECTION",
                     "GENERATING",
                     "MATCHING",
                     "PUBLISHING",
                     "STORING",
                     "SHARING",
                     "USING",
                     "OTHER"]
          },

          "purposes": {
            "enum": ["ADVERTISING",
                     "CONTRACT",
                     "CONTRACT.BASIC-SERVICE",
                     "CONTRACT.ADDITIONAL-SERVICES",
                     "NECESSARY",
                     "NECESSARY.JUSTICE"
                     "NECESSARY.LEGAL",
                     "NECESSARY.MEDICAL",
                     "NECESSARY.SOCIAL-PROTECTION",
                     "NECESSARY.PUBLIC-INTERESTS",
                     "NECESSARY.VITAL-INTERESTS",
                     "MARKETING",
                     "PERSONNALISATION",
                     "SALE",
                     "SECURITY",
                     "TRACKING",
                     "ANY"]
          },

          
        
         },
        
       

      },

}

  }
