{
  "$id": "https://blindnet.io/schemas/rights-request",
  "$schema": "https://json-schema.org/draft/2020-12/schema",

  "title": "Privacy Request",
  "description": "This document defines a format for interoperability of Privacy Requests",

  "type": "object",
  "properties": {
        "request-id": {
            "type": "string",
            "format": "uuid"
        },

        "data-subject": {
            "type": "array",
            "items": { "$ref": "#/$defs/data-subject-identity" },
            "minItems": 1
        },

         "demands": {
            "type": "array",
            "items": { "$ref": "#/$defs/demand" },
            "minItems": 1
        },

        "target": {
         "enum": ["DOWNWARD","UPWARD","BIDIRECTIONAL","INTRANSITIVE"],
         "default": "INTRANSITIVE",
        },

        "date": {
            "type": "string",
            "format": "date-time"
        },

    



  },

  "required": ["rights-request-id", "timestamp"],

  "definitions": {

  },

  "$defs": {
      "data-subject-identity": {
        "$id": "/schemas/data-subject-identity",
        "$schema": "https://json-schema.org/draft/2020-12/schema#",
        "type": "object",

        "properties": {
          "dsid-schema": { "type": "string" },
          "dsid": { "type": "string" },
         },

        "required": ["dsid-schema", "dsid"],

      },

     "demand": {
        "$id": "/schemas/demand",
        "$schema": "https://json-schema.org/draft/2020-12/schema#",
        "type": "object",

        "properties": {
          "demand-id": {
            "type": "string"
          },

          "message": {
            "type": "string"
          },

           "language": {
            "type": "string"
          },

           "legal-grounds": {
          "type": "array",
          "items": { "type": "string" }
        },

        "consent-ids": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          }
        },
      "capture-ids": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uuid"
          }
      }

          "action": {
            "enum":["ACCESS",
                    "DELETE",
                    "MODIFY",
                    "OBJECT",
                    "PORTABILITY",
                    "RESTRICT",
                    "REVOKE-CONSENT",
                    "TRANSPARENCY",
                    "TRANSPARENCY.DATA-CATEGORIES",
                    "TRANSPARENCY.DPO",
                    "TRANSPARENCY.KNOWN",
                    "TRANSPARENCY.LEGAL-BASES",
                    "TRANSPARENCY.ORGANISATION",
                    "TRANSPARENCY.POLICY",
                    "TRANSPARENCY.PROCESSING-CATEGORIES",
                    "TRANSPARENCY.PROVENANCE",
                    "TRANSPARENCY.PURPOSE",
                    "TRANSPARENCY.RETENTION",
                    "TRANSPARENCY.WHERE",
                    "TRANSPARENCY.WHO",
                    "OTHER"]
          },

         "data-categories": {
            "enum": ["AFFILIATION",
                     "BEHAVIOR",
                     "BEHAVIOR.ACTIVITY",
                     "BEHAVIOR.CONNECTION",
                     "BEHAVIOR.PREFERENCE",
                     "BIOMETRIC",
                     "CONTACT",
                     "CONTACT.EMAIL",
                     "CONTACT.ADDRESS",
                     "CONTACT.PHONE",
                     "DEMOGRAPHIC",
                     "DEMOGRAPHIC.AGE",
                     "DEMOGRAPHIC.BELIEFS",
                     "DEMOGRAPHIC.GENDER",
                     "DEMOGRAPHIC.ORIGIN",
                     "DEMOGRAPHIC.RACE",
                     "DEVICE",
                     "FINANCIAL",
                     "FINANCIAL.BANK-ACCOUNT",
                     "GENETIC",
                     "HEALTH",
                     "IMAGE",
                     "LOCATION",
                     "NAME",
                     "RELATIONSHIPS",
                     "PROFILING",
                     "UID",
                     "OTHER"]
         },

          "processing-categories": {
            "enum": ["ANONYMIZATION",
                     "AUTOMATED-INFERENCE",
                     "AUTOMATED-DECISION-MAKING",
                     "COLLECTION",
                     "GENERATING",
                     "MATCHING",
                     "PUBLISHING",
                     "STORING",
                     "SHARING",
                     "USING",
                     "OTHER"]
          },

          "purposes": {
            "enum": ["ADVERTISING",
                     "CONTRACT",
                     "CONTRACT.BASIC-SERVICE",
                     "CONTRACT.ADDITIONAL-SERVICES",
                     "NECESSARY",
                     "NECESSARY.JUSTICE"
                     "NECESSARY.LEGAL",
                     "NECESSARY.MEDICAL",
                     "NECESSARY.SOCIAL-PROTECTION",
                     "NECESSARY.PUBLIC-INTERESTS",
                     "NECESSARY.VITAL-INTERESTS",
                     "MARKETING",
                     "PERSONALISATION",
                     "SALE",
                     "SECURITY",
                     "TRACKING",
                     "ANY"]
          },



         },



      },

}

  }
